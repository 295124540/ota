<div class="main_hd">
    <h2>发布著书</h2>
    <div class="title_tab">
        <ul class="tab_navs title_tab">
            <li class="tab_nav first js_top"><a href="/admin/book_write" id="reloadTop">全部著书</a></li>
            <li class="tab_nav js_top selected"><a href="javascript:;" id="blackTop">发布著书</a></li>
        </ul>
    </div>
</div>
<div class="main_bd">

    <form action="/admin/book_write/save" enctype="multipart/form-data" method="post"
          class=" form goods_form goods_add_form">


        <div class="form_group">
            <label>书名</label><input name="name" type="text" maxlength="15"/>
        </div>

        <div class="form_group">
            <label>作者</label><input name="author" type="text" maxlength="15"/>
        </div>

        <div class="form_group" style="height: 450px;">
            <label>封面图</label>
            <div class="upload_img_box" style="text-align: center;width: 340px;">
                <div class="upload_img_label"
                     style="position:relative;width:320px;height:410px;text-align: center"></div>
                <input class="upload_img_input" accept="image/jpeg,image/jpg,image/png" type="file" name="cover_img"/>
            </div>
        </div>


        <div class="goods_desc_box form_group">
            <label>最新章节</label>
            <textarea name="content" rows="18" cols="50" placeholder="请更新最新章节" style="padding: 10px"></textarea>
            <!--
            <script class="ueditor" id="container" name="new_chapter" type="text/plain"></script>
            <script type="text/javascript" src="/ueditor/ueditor.config.js"></script>
            <script type="text/javascript" src="/ueditor/ueditor.all.js"></script>
            <script type="text/javascript">
                var ue = UE.getEditor('container',{
                    // initialFrameWidth:800,
                    // initialFrameHeight:300
                });
            </script>
            -->
        </div>
        <div class="current_box">
            <input type="button" onclick="submit()" name="next" class="next btn btn_primary " value="提交"/>
        </div>

    </form>
</div>

<script src="//cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
<script src="/static/js/jquery.easing.min.js" type="text/javascript"></script>
<script src="/static/js/zzsc.js" type="text/javascript"></script>

<script>

    $(function () {

        $(".upload_img_label").on('click', function (e) {

            var index = $(".upload_img_label").index(this);
            $('.upload_img_input').eq(index).click();
        })

        $(".upload_img_input").on("change", function () {

            var objUrl = getObjectURL(this.files[0]); //获取图片的路径，该路径不是图片在本地的路径
            if (objUrl) {

                var index = $(".upload_img_input").index(this);

                var tempStr = "<img class='thumb' style='position:relative;width: 300px;height: 400px' />",
                        $label = $(".upload_img_label").eq(index);

                $label.append(tempStr);
                console.log($label.find('img.thumb'));
                $label.find('img.thumb').attr('src', objUrl);

            }

        });
    });

    function getObjectURL(file) {
        var url = null;
        if (window.createObjectURL != undefined) { // basic
            url = window.createObjectURL(file);
        } else if (window.URL != undefined) { // mozilla(firefox)
            url = window.URL.createObjectURL(file);
        } else if (window.webkitURL != undefined) { // webkit or chrome
            url = window.webkitURL.createObjectURL(file);
        }
        return url;
    }

    function submit() {
        // return false;
        document.form[0].submit();
    }
</script>
